If you want more information about using a particular part of the api, the {\bfseries{Topical Tutorials}} offer longer examples and more detail about using the P\+R\+OS A\+PI.


\begin{DoxyItemize}
\item \mbox{\hyperlink{adi}{A\+DI (3 Wire Ports)}}
\item \mbox{\hyperlink{controller}{Controller}}
\item \mbox{\hyperlink{display}{V5 Brain Display (L\+V\+GL)}}
\item \mbox{\hyperlink{filesystem}{Filesystem}}
\item \mbox{\hyperlink{jinx}{J\+I\+NX Graphical Debugger}}
\item \mbox{\hyperlink{llemu}{L\+L\+E\+MU (Legacy L\+CD Emulator)}}
\item \mbox{\hyperlink{motors}{Motors}}
\item \mbox{\hyperlink{multitasking}{Multitasking}}
\item \mbox{\hyperlink{notifications}{Task Notifications}}
\item \mbox{\hyperlink{vision}{Vision Sensor}}
\item \mbox{\hyperlink{wireless-upload}{Wireless Upload and Hot/\+Cold Linking}} 
\end{DoxyItemize}\hypertarget{adi}{}\doxysection{A\+DI (3 Wire Ports)}\label{adi}
\begin{DoxyNote}{Note}
For a full list of functions for interacting with the A\+DI, see its \+: \href{../../api/c/adi.html}{\texttt{ C A\+PI}} and \href{../../api/cpp/adi.html}{\texttt{ C++ A\+PI}}.
\end{DoxyNote}
\hypertarget{adi_autotoc_md29}{}\doxysubsubsection{Analog Sensors}\label{adi_autotoc_md29}
While computers, microcontrollers, and other devices that interface with V\+EX robots are digital systems, most of the real world operates as analog components, where a range of possible values exist instead of simply an arrangement of 1s and 0s. Analog sensors like potentiometers and line trackers are used to communicate with these analog real-\/world systems. These sensors return a number within a preset range of values in accordance with their input, as opposed to a digit sensor which simply returns an on or off state.

To take these analog inputs and convert them to information that the Cortex can actually use, A\+D\+Cs (Analog to Digital Converters) are used on each of the Analog In ports to convert the analog input signals (varying voltage signals) to 12 bit integers. As a result, the range of all analog sensors when used with the Cortex is 0 to 4095 (the range of a 12 bit unsigned integer).\hypertarget{adi_autotoc_md30}{}\doxyparagraph{Initialization}\label{adi_autotoc_md30}
As with all A\+DI sensors, the first step to using the sensor is to set the configuration for its A\+DI port.

Additionally, it is often worthwhile to calibrate analog sensors before using them in the {\ttfamily \mbox{\hyperlink{main_8h_a9efe22aaead3a5e936b5df459de02eba}{initialize()}}} function. The \href{../../api/c/adi.html\#adi-analog-calibrate}{\texttt{ analog\+\_\+calibrate}} function collects approximately 500 data samples over a period of half a second and returns the average value received over the sampling period. This average value can be used to account for variations like ambient light for line trackers.\hypertarget{adi_autotoc_md31}{}\doxyparagraph{Potentiometer}\label{adi_autotoc_md31}
Potentiometers measure angular position and can be used to determine the direction of rotation of its input. Potentiometers are best used in applications such as lifts where the sensor is not at risk of being rotated beyond its 250-\/degree physical constraint. Potentiometers typically do not need to be calibrated, although it may be desired as it helps account for possible shifting in the potentiometer mounting and to find the actual range of the potentiometer due to its mechanical stops as that range may be closer to 5-\/4090 instead of 0-\/4095. If the potentiometer is not calibrated, the \href{../../api/c/adi.html\#adi-analog-read}{\texttt{ analog\+\_\+read}} function may be used to obtain the raw input value of the potentiometer. If the sensor was calibrated, the \href{../../api/c/adi.html\#adi-analog-read-calibrated}{\texttt{ analog\+\_\+read\+\_\+calibrated}} function should be used, as it will account for the sensor\textquotesingle{}s calibration and return more accurate results. The input to both of these functions is the channel number of the sensor, and an integer is returned.

Thus an example of use on a lift would look like\+:\hypertarget{adi_autotoc_md32}{}\doxyparagraph{Line Tracker}\label{adi_autotoc_md32}
V\+EX Line Trackers operate by measuring the amount of light reflected to the sensor and determining the existence of lines from the difference in light reflected by the white tape and the dark tiles. The Line Trackers return a value between 0 and 4095, with 0 being the lightest reading and 4095 the darkest. It is recommended that Line Trackers be calibrated to account for changes in ambient light.

An example of Line Tracker use\+:\hypertarget{adi_autotoc_md33}{}\doxyparagraph{Accelerometer}\label{adi_autotoc_md33}
The V\+EX Accelerometer measures acceleration on the x, y, and z axes simultaneously. Accelerometers can be used to infer velocity and displacement, but due to the error induced by such integration it is recommended that simply the acceleration data be used. By design of the V\+EX Accelerometer each axis is treated as its own analog sensors. Due to this the V\+EX Accelerometer requires three analog input ports on the Cortex.

Example accelerometer use\+:\hypertarget{adi_autotoc_md34}{}\doxysubsubsection{Digital Sensors}\label{adi_autotoc_md34}
\hypertarget{adi_autotoc_md35}{}\doxyparagraph{Initialization}\label{adi_autotoc_md35}
As with all A\+DI sensors, the first step to using the sensor is to set the configuration for its A\+DI port.

From there, using a digital sensor is fairly straightforward. Digital Sensors always return a true or false (boolean) value.\hypertarget{adi_autotoc_md36}{}\doxyparagraph{Quad Encoder}\label{adi_autotoc_md36}
Quadrature encoders can measure the rotation of the attached axle on your robot. Most common uses of this sensor type are to track distance traveled by attaching them to your robots drivetrain and monitoring how much the axle spins.

With these sensors 1 measured tick is 1 degree of revolution.

\begin{DoxyNote}{Note}
Encoders must be plugged into the A\+DI such that the top wire is in an odd numbered port (1, 3, 5, 7 or \textquotesingle{}A\textquotesingle{}, \textquotesingle{}C\textquotesingle{}, \textquotesingle{}E\textquotesingle{}, or \textquotesingle{}G\textquotesingle{}), and then the bottom wire must be in the next highest port number. Encoders are initialized as such\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{main_8h_a9efe22aaead3a5e936b5df459de02eba}{initialize}}() \{}
\DoxyCodeLine{  encoder = \mbox{\hyperlink{adi_8h_a68a71dd59fce0ad9a6c6e2e49892639f}{adi\_encoder\_init}}(QUAD\_TOP\_PORT, QUAD\_BOTTOM\_PORT, \textcolor{keyword}{false});}
\DoxyCodeLine{\}}
\end{DoxyCode}

\end{DoxyNote}
And then used in the following manner\+:\hypertarget{adi_autotoc_md37}{}\doxyparagraph{Ultrasonic}\label{adi_autotoc_md37}
Ultrasonic sensors are used in a manner that is very similar to encoders, given that they are both two-\/wire sensors.

\begin{DoxyNote}{Note}
Ultrasonic sensors must be plugged into the A\+DI such that the P\+I\+NG wire (the orange O\+U\+T\+P\+UT cable) is in an odd numbered port (1, 3, 5, 7 or \textquotesingle{}A\textquotesingle{}, \textquotesingle{}C\textquotesingle{}, \textquotesingle{}E\textquotesingle{}, or \textquotesingle{}G\textquotesingle{}), and then the E\+C\+HO wire (the yellow I\+N\+P\+UT cable) must be in the next highest port number. Ultrasonic sensors are initialized as such\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{main_8h_a9efe22aaead3a5e936b5df459de02eba}{initialize}}() \{}
\DoxyCodeLine{   ultrasonic = \mbox{\hyperlink{adi_8h_abc86207973ae101d00b51ffa7b4415e7}{adi\_ultrasonic\_init}}(ULTRA\_PING\_PORT, ULTRA\_ECHO\_PORT);}
\DoxyCodeLine{ \}}
\end{DoxyCode}

\end{DoxyNote}
And then used in the following manner\+:\hypertarget{adi_autotoc_md38}{}\doxyparagraph{Pneumatics}\label{adi_autotoc_md38}
Pneumatics in V\+EX provide two-\/state linear actuation. They differ from other digital sensors in that they are output signals. Therefore, the default digital sensor configuration is insufficient.

And then the pneumatics are used as such\+: \hypertarget{controller}{}\doxysection{Controller}\label{controller}
\begin{DoxyNote}{Note}
For a full list of functions for interacting with the V5 Controller, see its \href{../../api/c/misc.html}{\texttt{ C A\+PI}} and \href{../../api/cpp/misc.html}{\texttt{ C++ A\+PI}}. Feedback from the V5 Controller comes in two forms -\/ analog and digital. The analog data comes from the \href{https://en.wikipedia.org/wiki/Analog_stick}{\texttt{ joysticks}}, and the digital data comes from the buttons.
\end{DoxyNote}
The analog data is a value in the range of \mbox{[}-\/127,127\mbox{]}, and digital data is either 1 or 0 (pressed or unpressed, respectively).\hypertarget{controller_autotoc_md39}{}\doxysubsubsection{Analog Data}\label{controller_autotoc_md39}
Retrieve analog values from the V5 Controller in the following manner\+:

The controller returns a range of \mbox{[}-\/127,127\mbox{]} for analog data, which is why the \href{../../api/c/motors.html\#motor-move}{\texttt{ motor\+\_\+move}} function is appropriate for easy use with the controllers.\hypertarget{controller_autotoc_md40}{}\doxysubsubsection{Digital Data}\label{controller_autotoc_md40}
Retrieve Digital Values from the V5 Controller in the following manner\+: \hypertarget{display}{}\doxysection{V5 Brain Display (L\+V\+GL)}\label{display}
Interacting with the touchscreen on the V5 Brain is made possible through \href{https://littlevgl.com}{\texttt{ L\+V\+GL}}. L\+V\+GL is a full-\/featured C graphics library (it\textquotesingle{}s accessible in C++ projects too under the same A\+PI).

The first step to getting started with L\+V\+GL is to include {\ttfamily \mbox{\hyperlink{apix_8h}{pros/apix.\+h}}} in your {\ttfamily \mbox{\hyperlink{main_8h}{main.\+h}}} file or other header files. This includes the full L\+V\+GL feature set as described in their documentation\+: \href{https://littlevgl.com/}{\texttt{ https\+://littlevgl.\+com/}}

You can follow along with any of the L\+V\+GL \href{https://github.com/littlevgl/lv_examples/tree/master/lv_tutorial}{\texttt{ tutorials}} or \href{https://docs.littlevgl.com/\#Objects}{\texttt{ wiki}}. There is no need to port or initialize L\+V\+GL, you can simply start creating objects.

\begin{DoxyNote}{Note}
Custom L\+V\+GL code cannot be displayed at the same time as the \href{./llemu.html}{\texttt{ L\+L\+E\+MU}}. As a result, you must remove the L\+L\+E\+MU code ({\ttfamily \mbox{\hyperlink{namespacepros_1_1lcd}{pros\+::lcd}}}) that is present in {\ttfamily main.\+cpp} by default in a new project. 
\end{DoxyNote}
\hypertarget{filesystem}{}\doxysection{Filesystem}\label{filesystem}
You can interact with files on the micro\+SD card (you can {\bfseries{not}} interact with files on the V5 brain\textquotesingle{}s flash) through standard C/\+C++ file I/O methods. For the most part, you can follow along with any standard C tutorial for file I/O and it will work with P\+R\+OS. Here are a couple of recommended tutorials\+:


\begin{DoxyItemize}
\item \href{https://www.cprogramming.com/tutorial/cfileio.html}{\texttt{ https\+://www.\+cprogramming.\+com/tutorial/cfileio.\+html}}
\item \href{https://www.tutorialspoint.com/cprogramming/c_file_io.htm}{\texttt{ https\+://www.\+tutorialspoint.\+com/cprogramming/c\+\_\+file\+\_\+io.\+htm}}
\end{DoxyItemize}

The only additional detail needed for interacting with the filesystem in P\+R\+OS is that any files on the micro\+SD card {\bfseries{must}} be prefaced with {\ttfamily /usd/}. A file on the micro\+SD card can be written to in the following manner\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{FILE* usd\_file\_write = fopen(\textcolor{stringliteral}{"/usd/example.txt"}, \textcolor{stringliteral}{"w"});}
\DoxyCodeLine{fputs(\textcolor{stringliteral}{"Example text"}, usd\_file\_write);}
\DoxyCodeLine{fclose(usd\_file\_write);}
\DoxyCodeLine{}
\DoxyCodeLine{FILE* usd\_file\_read = fopen(\textcolor{stringliteral}{"/usd/example.txt"}, \textcolor{stringliteral}{"r"});}
\DoxyCodeLine{\textcolor{keywordtype}{char} buf[50]; \textcolor{comment}{// This just needs to be larger than the contents of the file}}
\DoxyCodeLine{fread(buf, 1, 50, usd\_file\_read); \textcolor{comment}{// passing 1 because a `char` is 1 byte, and 50 b/c it's the length of buf}}
\DoxyCodeLine{printf(\textcolor{stringliteral}{"\%s\(\backslash\)n"}, buf); \textcolor{comment}{// print the string read from the file}}
\DoxyCodeLine{\textcolor{comment}{// Should print "Example text" to the terminal}}
\DoxyCodeLine{fclose(usd\_file\_read); \textcolor{comment}{// always close files when you're done with them}}
\end{DoxyCode}
\hypertarget{filesystem_autotoc_md41}{}\doxysubsubsection{Remarks}\label{filesystem_autotoc_md41}
The micro\+SD card must be fat32 in order to work.\hypertarget{filesystem_autotoc_md42}{}\doxyparagraph{Serial}\label{filesystem_autotoc_md42}
It\textquotesingle{}s also possible to interact with the serial communications ({\ttfamily stdin}, {\ttfamily stdout}, etc.) through the filesystem drivers. You can write and read from these streams in the same manner as a file, but using the four character stream identifiers.

For instance, you can write to {\ttfamily stderr} in the following manner\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{FILE* stderr = fopen(\textcolor{stringliteral}{"serr"}, \textcolor{stringliteral}{"w"});}
\DoxyCodeLine{fputs(\textcolor{stringliteral}{"Example text"}, stderr);}
\DoxyCodeLine{fclose(usd\_file\_write);}
\end{DoxyCode}


There are also a number of methods for controlling serial communication behavior exposed in \href{../../extended/apix.html}{\texttt{ apix.\+h}}. These methods can be accessed through the {\ttfamily \mbox{\hyperlink{apix_8h_a962daefd6f45a8def6ff00802a23fbff}{serctl()}}} function. At the moment two actions are supported -\/activating/deactivating the streams, and enabling/disabling \href{https://en.wikipedia.org/wiki/Consistent_Overhead_Byte_Stuffing}{\texttt{ C\+O\+BS}} . If you want to read the serial comms yourself (without using {\ttfamily pros terminal}), then you\textquotesingle{}ll want to disable C\+O\+BS. \hypertarget{jinx}{}\doxysection{J\+I\+NX Graphical Debugger}\label{jinx}
\begin{DoxyWarning}{Warning}
This will be completed when J\+I\+NX is finalized for an upcoming minor version increment. 
\end{DoxyWarning}
\hypertarget{llemu}{}\doxysection{L\+L\+E\+MU (Legacy L\+CD Emulator)}\label{llemu}
\begin{DoxyNote}{Note}
For a full list of functions for interacting with the L\+L\+E\+MU, see its $>$\href{../../api/c/llemu.html}{\texttt{ C A\+PI}} and \href{../../api/cpp/llemu.html}{\texttt{ C++ A\+PI}}.
\end{DoxyNote}
\hypertarget{llemu_autotoc_md43}{}\doxysubsubsection{Initialization}\label{llemu_autotoc_md43}
Initialization of the L\+L\+E\+MU is very simple, it\textquotesingle{}s just a call to its initialization function at whatever point in the program you would like the L\+L\+E\+MU to start displaying (this will most likely be in {\ttfamily \mbox{\hyperlink{main_8h_a9efe22aaead3a5e936b5df459de02eba}{initialize()}}}).

Initialization is done as such\+:\hypertarget{llemu_autotoc_md44}{}\doxysubsubsection{Writing to the L\+L\+E\+MU}\label{llemu_autotoc_md44}
Writing to the L\+L\+E\+MU is nearly identical to writing to the L\+CD with \href{../../cortex/tutorials/lcd.html}{\texttt{ P\+R\+OS 2}}. Most writing should be done with the print function, which is analogous to \href{http://www.cplusplus.com/reference/cstdio/printf/}{\texttt{ printf}}.\hypertarget{llemu_autotoc_md45}{}\doxysubsubsection{Using the Buttons}\label{llemu_autotoc_md45}
Using the buttons can be done in a similar method to \href{../../../cortex/tutorials/lcd.html}{\texttt{ P\+R\+OS 2}} with the \href{../../api/cpp/llemu.html\#read-buttons}{\texttt{ pros\+::lcd\+::read\+\_\+buttons}} function. See the above example for printing the button readings.

While this is sufficient for most applications, some tasks are easier to perform using the \href{../../api/cpp/llemu.html\#register-btn0-cb}{\texttt{ pros\+::lcd\+::register\+\_\+btn\#\+\_\+cb}} functions (where \# is replaced with 0, 1, or 2 for the left, center, and right buttons respectively). With these function you can assign a function to be called each time that the button is pressed.

\begin{DoxyNote}{Note}
Custom L\+V\+GL code cannot be displayed at the same time as L\+L\+E\+MU. 
\end{DoxyNote}
\hypertarget{motors}{}\doxysection{Motors}\label{motors}
\begin{DoxyNote}{Note}
For a full list of functions for interacting with the V5 Motors, see its \href{../../api/c/motors.html}{\texttt{ C A\+PI}} and \href{../../api/cpp/motors.html}{\texttt{ C++ A\+PI}}.
\end{DoxyNote}
\hypertarget{motors_autotoc_md46}{}\doxysubsubsection{Initialization}\label{motors_autotoc_md46}
V5 Motors should be configured before use in your code. Configuration options like the gearset and encoder units are important to address first thing in your user program to ensure that functions like \href{../../api/c/motors.html\#motor-move-velocity}{\texttt{ motor\+\_\+move\+\_\+velocity}} will work as expected.

When declaring motors in C++, it is not necessary to set the configuration for the motor with its constructor (beyond its port number) more than once for the given port. An example of this is given below.

\begin{quote}
\begin{quote}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#define MOTOR\_PORT 1}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{main_8h_a1903abdb5ef0f301d660754c8315fc17}{opcontrol}}() \{}
\DoxyCodeLine{  \mbox{\hyperlink{classpros_1_1Motor}{pros::Motor}} drive\_left (MOTOR\_PORT);}
\DoxyCodeLine{  \textcolor{comment}{// drive\_left will have the same configuration as drive\_left\_initializer}}
\DoxyCodeLine{\}}
\end{DoxyCode}


\end{quote}
\end{quote}
\hypertarget{motors_autotoc_md47}{}\doxysubsubsection{Simple Usage}\label{motors_autotoc_md47}
The easiest way to interact with the motors is through the \href{../../api/c/motors.html\#motor-move}{\texttt{ motor\+\_\+move}} function. This is analogous to the \href{../../../cortex/api/index.html\#motorSet}{\texttt{ motor\+Set}} function from P\+R\+OS 2.\hypertarget{motors_autotoc_md48}{}\doxysubsubsection{Autonomous Movement}\label{motors_autotoc_md48}
The V5 Motors can move in a number of different ways that are better suited towards autonomous movement than the simple {\ttfamily \mbox{\hyperlink{motors_8h_a7da9bf1e229e50bfeeaecf026a6d0d08}{motor\+\_\+move()}}} example shown above.\hypertarget{motors_autotoc_md49}{}\doxyparagraph{Profile Movements}\label{motors_autotoc_md49}
Profile movements are movements to a given position that are executed by the motor\textquotesingle{}s firmware. There are two functions that achieve this, {\ttfamily \mbox{\hyperlink{motors_8h_ab70bf4937f1b5cefa15c11c15314c90e}{motor\+\_\+move\+\_\+absolute()}}} and {\ttfamily \mbox{\hyperlink{motors_8h_ab4c1ba35d69e8e9b49df0e848fa305d3}{motor\+\_\+move\+\_\+relative()}}}. These two functions are practically similar, but {\ttfamily \mbox{\hyperlink{motors_8h_ab4c1ba35d69e8e9b49df0e848fa305d3}{motor\+\_\+move\+\_\+relative()}}} takes into account the zero position of the motor\textquotesingle{}s encoder.

These functions are very well suited to movement in autonomous.

For further reading material on the algorithms that create these profiled movement, see \href{https://pdfs.semanticscholar.org/a229/fdba63d8d68abd09f70604d56cc07ee50f7d.pdf}{\texttt{ Mathematics of Motion Control Profiles}} for the \href{https://en.wikipedia.org/wiki/Feed_forward_(control)}{\texttt{ Feedforward}} control, and \href{http://georgegillard.com/documents/2-introduction-to-pid-controllers}{\texttt{ George Gillard\textquotesingle{}s P\+ID Explanation}} for the \href{https://en.wikipedia.org/wiki/Control_theory\#PID_feedback_control}{\texttt{ feedback}} control.\hypertarget{motors_autotoc_md50}{}\doxyparagraph{Velocity Controller Movement}\label{motors_autotoc_md50}
The final {\ttfamily move} function available with the P\+R\+OS Motor A\+PI is {\ttfamily \mbox{\hyperlink{motors_8h_a5a366399c1ff416002641fd05e6d7808}{motor\+\_\+move\+\_\+velocity()}}}. This ensures consistent velocity output from the motor through the use of \href{http://georgegillard.com/documents/2-introduction-to-pid-controllers}{\texttt{ P\+ID}}.\hypertarget{motors_autotoc_md51}{}\doxysubsubsection{Telemetry}\label{motors_autotoc_md51}
The V5 motors return a plethora of diagnostic information about their performance. The motors return the following parameters\+:

Parameter C Function C++ Function

\DoxyHorRuler{0}


Position \href{../../api/c/motors.html\#motor-get-position}{\texttt{ motorggetpposition}} \mbox{[}\mbox{\hyperlink{classpros_1_1Motor_a70e725a94ec42dc7cbb3e460c36dcad3}{pros\+::\+Motor\+::get\+\_\+position}}\mbox{]}(get\+\_\+position\+\_\+) Velocity \href{../../api/c/motors.html\#motor-get-actual-velocity}{\texttt{ motorggetaactualvvelocity}} \mbox{[}\mbox{\hyperlink{classpros_1_1Motor_a696494a4e7c675f7007d41b947f9ea63}{pros\+::\+Motor\+::get\+\_\+actual\+\_\+velocity}}\mbox{]}(get\+\_\+actual\+\_\+velocity\+\_\+) Current \href{../../api/c/motors.html\#motor-get-current-draw}{\texttt{ motorggetccurrentddraw}} \mbox{[}\mbox{\hyperlink{classpros_1_1Motor_a502eaf3859452721e2327e53ab3f34d8}{pros\+::\+Motor\+::get\+\_\+current\+\_\+draw}}\mbox{]}(get\+\_\+current\+\_\+draw\+\_\+) Efficiency \href{../../api/c/motors.html\#motor-get-efficiency}{\texttt{ motorggeteefficiency}} \mbox{[}\mbox{\hyperlink{classpros_1_1Motor_a6f0b39894abf612a1965a66224893c71}{pros\+::\+Motor\+::get\+\_\+efficiency}}\mbox{]}(get\+\_\+efficiency\+\_\+) Power \href{../../api/c/motors.html\#motor-get-power}{\texttt{ motorggetppower}} \mbox{[}\mbox{\hyperlink{classpros_1_1Motor_a51b75dc245257487116e64fa2904d521}{pros\+::\+Motor\+::get\+\_\+power}}\mbox{]}(get\+\_\+power\+\_\+) Temperature \href{../../api/c/motors.html\#motor-get-temperature}{\texttt{ motorggetttemperature}} \mbox{[}\mbox{\hyperlink{classpros_1_1Motor_a9fd793251b91c2ac0091c65f290f740d}{pros\+::\+Motor\+::get\+\_\+temperature}}\mbox{]}(get\+\_\+temperature\+\_\+) Torque \href{../../api/c/motors.html\#motor-get-torque}{\texttt{ motorggetttorque}} \mbox{[}\mbox{\hyperlink{classpros_1_1Motor_a14e0c57c0ca7bde15f73414abf4c3c8e}{pros\+::\+Motor\+::get\+\_\+torque}}\mbox{]}(get\+\_\+torque\+\_\+) Voltage \href{../../api/c/motors.html\#motor-get-voltage}{\texttt{ motorggetvvoltage}} \mbox{[}\mbox{\hyperlink{classpros_1_1Motor_abe51732c37c2ec72a8bdceac7f6962cb}{pros\+::\+Motor\+::get\+\_\+voltage}}\mbox{]}(get\+\_\+voltage\+\_\+) Direction \href{../../api/c/motors.html\#motor-get-direction}{\texttt{ motorggetddirection}} \mbox{[}\mbox{\hyperlink{classpros_1_1Motor_acea42a96da651f72f138ea268c76217f}{pros\+::\+Motor\+::get\+\_\+direction}}\mbox{]}(get\+\_\+direction\+\_\+) \hypertarget{multitasking}{}\doxysection{Multitasking}\label{multitasking}
\begin{DoxyNote}{Note}
For a full list of functions for interacting with Tasks, see its \href{../../api/c/rtos.html}{\texttt{ C A\+PI}} and \href{../../api/cpp/rtos.html}{\texttt{ C++ A\+PI}}. Tasks are a great tool to do multiple things at once, but they can be difficult to use properly. The most important thing to remember when using tasks is that tasks aren\textquotesingle{}t truly running in the background -\/ they are run one at a time and swapped out by the P\+R\+OS scheduler. If your task performs some repeated action (e.\+g. a {\ttfamily while} loop), you should include a {\ttfamily \mbox{\hyperlink{rtos_8h_ab8c5a8048d5576a33d7f79b95a2fa0dd}{delay()}}} or {\ttfamily \mbox{\hyperlink{rtos_8h_a61c8ccf83a0dc79fc0e9fde5e87a0329}{task\+\_\+delay\+\_\+until()}}}. Without a {\ttfamily \mbox{\hyperlink{rtos_8h_ab8c5a8048d5576a33d7f79b95a2fa0dd}{delay()}}} statement, your task could starve the processor of resources and prevent the kernel from running properly.
\end{DoxyNote}
The P\+R\+OS task scheduler is a preemptive, priority-\/based, round-\/robin scheduler. This means that tasks are preempted (interrupted) every millisecond to determine if another task ought to run. P\+R\+OS decides which task to run next based on all of the ready tasks\textquotesingle{} priorities.

\begin{quote}

\begin{DoxyItemize}
\item Tasks which are eligible for execution are called \char`\"{}ready.\char`\"{} Tasks are typically not ready because they may be sleeping (in a {\ttfamily task\+\_\+delay}) or blocked waiting for a synchronization mechanism (e.\+g. a mutex or semaphore).
\item The higher the priority, the more crucial the task is considered, and more C\+PU time will be awarded to the task. Ready tasks of higher priority will always run in preference to lower priority tasks.
\item Tasks of equal priority take preference when a task is preempted. In other words, if tasks A and B have equal priority, then when A is interrupted, B will run next, even if A is still eligible for execution. This is called round-\/robin scheduling. 
\end{DoxyItemize}\end{quote}
\hypertarget{multitasking_autotoc_md53}{}\doxysubsubsection{On the Abuse of Tasks}\label{multitasking_autotoc_md53}
Tasks are very often misused and abused in ways that make the P\+R\+OS kernel behave in unintended ways. The following list are some commonly made mistakes and guidelines for using Tasks in P\+R\+OS.

\begin{quote}

\begin{DoxyItemize}
\item Tasks in real-\/time operating systems should be long-\/living. That is, tasks should not typically perform a short operation and then die. Consider re-\/working the logic of your program to enable such behavior.
\item \char`\"{}\+Task functions\char`\"{} are not special, except that their signature needs to be correct. In other programming environments for V\+EX, tasks must be marked with a special keyword. With most modern programming environments, tasks are just functions that get executed asynchronously.
\item It was mentioned above, but it\textquotesingle{}s important enough for a second mention\+: every tasks\textquotesingle{} loop should have a {\ttfamily \mbox{\hyperlink{rtos_8h_ab8c5a8048d5576a33d7f79b95a2fa0dd}{delay()}}} statement. 
\end{DoxyItemize}\end{quote}
\hypertarget{multitasking_autotoc_md54}{}\doxyparagraph{Task Management}\label{multitasking_autotoc_md54}
Tasks in P\+R\+OS are simple to create\+:

The \href{../../api/c/rtos.html\#task_create}{\texttt{ task\+\_\+create}} function takes in a function where the task starts, an argument to the function, a priority for the task, and two new fields not yet discussed\+: stack size and name.

Stack size describes the amount of stack space that is allocated for the task. The stack is an area for your program to store variables, return addresses for functions, and more. Real-\/time operating systems like P\+R\+OS work in limited-\/memory situations and do not allow for a dynamically resizable stack. Modern desktop operating systems do not need to worry about stack space as much as you would in a R\+T\+OS. The good news is that most tasks should opt to use {\ttfamily T\+A\+S\+K\+\_\+\+S\+T\+A\+C\+K\+\_\+\+D\+E\+P\+T\+H\+\_\+\+D\+E\+F\+A\+U\+LT}, which should provide ample stack space for nearly any task. Very rudimentary and simple tasks (e.\+g. not many nested functions, no floating point context, few variables, only C) may be able to use {\ttfamily T\+A\+S\+K\+\_\+\+S\+T\+A\+C\+K\+\_\+\+D\+E\+P\+T\+H\+\_\+\+M\+IN}.

The last parameter is the task name. The task name allows you to give a task a human-\/friendly name for the task. It is primarily for debugging purposes and allows you (the human) to easily identify tasks if performing advanced task management. Task names may be up to 32 characters long, and you may pass N\+U\+LL or an empty string into the function. In A\+P\+I2, \href{../../../cortex/api/index.html\#taskCreate}{\texttt{ task\+Create}} will automatically make the task name an empty string.\hypertarget{multitasking_autotoc_md55}{}\doxyparagraph{Synchronization}\label{multitasking_autotoc_md55}
One problem which one often runs into when dealing with tasks is the problem of synchronization. If two tasks try to read the same sensor or control the same motor at the same time, unexpected behavior may occur since two tasks are trying to write to the same piece of data or variable (i.\+e. \href{https://en.wikipedia.org/wiki/Race_condition\#Software}{\texttt{ race conditions}}). The concept of writing code which has protections against race conditions is called thread safety. There are many different ways to implement thread safety, and P\+R\+OS has several facilities to help maintain thread safety.

The simplest way to ensure thread safety is to design tasks which will never access the same variables or data. You may design your code to have each subsystem of your robot in its own task. Ensuring that tasks never write to the same variables is called division of responsibility or separation of domain.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{int} task1\_variable = 0;}
\DoxyCodeLine{\textcolor{keywordtype}{void} Task1(\textcolor{keywordtype}{void} * ignore) \{}
\DoxyCodeLine{    \textcolor{comment}{// do things}}
\DoxyCodeLine{    task1\_variable = 4;}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{void} Task2(\textcolor{keywordtype}{void} * ignore) \{}
\DoxyCodeLine{  \textcolor{comment}{// do things}}
\DoxyCodeLine{  \textcolor{comment}{// I can read task1\_variable, but NOT write to it}}
\DoxyCodeLine{  printf(\textcolor{stringliteral}{"\%d\(\backslash\)n"}, task1\_variable);}
\DoxyCodeLine{\}}
\end{DoxyCode}


Sometimes this is impossible\+: suppose you wanted to write a P\+ID controller on its own task and you wanted to change the target of the P\+ID controller. P\+R\+OS features two types of synchronization structures, {\itshape mutexes} and {\itshape notifications} that can be used to coordinate tasks.\hypertarget{multitasking_autotoc_md56}{}\doxysubsubsection{Mutexes}\label{multitasking_autotoc_md56}
Mutexes stand for mutual exclusion; only one task can hold a mutex at any given time. Other tasks must wait for the first task to finish (and release the mutex) before they may continue.

Mutexes do not magically prevent concurrent writing, but provide the ability for tasks to create \char`\"{}contracts\char`\"{} with each other. You can write your code such that a variable is never written to unless the task owns a mutex designated for that variable.\hypertarget{multitasking_autotoc_md57}{}\doxysubsubsection{Notifications}\label{multitasking_autotoc_md57}
Task notifications are a powerful new feature in P\+R\+OS 3 which allows direct-\/to-\/task synchronization. A full tutorial on task notifications can be found \mbox{\hyperlink{notifications}{Task Notifications}}. \hypertarget{notifications}{}\doxysection{Task Notifications}\label{notifications}
\begin{DoxyNote}{Note}
For a full list of functions for interacting with Tasks, see its \href{../../api/c/rtos.html}{\texttt{ C A\+PI}} and \href{../../api/cpp/rtos.html}{\texttt{ C++ A\+PI}}. Task notifications are a powerful new feature in P\+R\+OS 3 which allows direct-\/to-\/task synchronization. Each task has a 32-\/bit notification value. Each task can block on its own notification (wait for it to become non-\/zero) and any task can update the notification value. Task notifications have a broad range of applications, are simple to use, and have significant memory and speed advantages when compared to traditional semaphore-\/based synchronization mechanisms.
\end{DoxyNote}
The simplest application of task notifications does not care about the task notification value\+: \hypertarget{vision}{}\doxysection{Vision Sensor}\label{vision}
\begin{DoxyNote}{Note}
For a full list of functions for interacting with the V5 Vision Sensor, see its \href{../../api/c/vision.html}{\texttt{ C A\+PI}} and \href{../../api/cpp/vision.html}{\texttt{ C++ A\+PI}}.
\end{DoxyNote}
\hypertarget{vision_autotoc_md58}{}\doxysubsubsection{Setting Signatures}\label{vision_autotoc_md58}
The first step to using the vision sensor is setting color signatures for the sensor to recognize as objects. This is done through the V5 Vision Utility program.\hypertarget{vision_autotoc_md59}{}\doxysubsubsection{Retrieving Objects}\label{vision_autotoc_md59}
The primary function of the vision sensor is returning objects, or blobs of color detected by the sensor. The characteristics of an object are defined in \href{../../api/c/vision.html\#vision_object_s_t}{\texttt{ vision\+\_\+object\+\_\+s\+\_\+t}}.\hypertarget{vision_autotoc_md60}{}\doxyparagraph{By Size}\label{vision_autotoc_md60}
The simplest way to interact with the vision sensor is to get an object by its size. 0 is the largest object detected by the sensor.\hypertarget{vision_autotoc_md61}{}\doxyparagraph{By Signature}\label{vision_autotoc_md61}
If you have multiple signatures saved to the vision signature, you will most likely want to only look for objects of a particular signature. The {\ttfamily get\+\_\+by\+\_\+sig()} function implements this functionality.\hypertarget{vision_autotoc_md62}{}\doxysubsubsection{Changing the Object Coordinates}\label{vision_autotoc_md62}
Each returned object from the vision sensor comes with a set of coordinates telling where the object was found in the vision sensor\textquotesingle{}s field of view. The default behavior is to return the coordinates as a function of distance from the top left corner of the field of view -\/ so positive y is downward and positive x is right. With the P\+R\+OS A\+PI, you can change this behavior so that the center of the Field Of View is the (0,0) point for object coordinates. Positive y is still downward and positive x is still right, but negative y is upward of center and negative x is left of center in this configuration.\hypertarget{vision_autotoc_md63}{}\doxysubsubsection{Exposure Setting}\label{vision_autotoc_md63}
In P\+R\+OS Kernel 3.\+1.\+4 and earlier, the vision sensor exposure parameter was in the range \mbox{[}0,58\mbox{]}. In P\+R\+OS Kernel 3.\+1.\+5 and newer, the parameter is scaled to be in the range \mbox{[}0,150\mbox{]} to match the Vision Sensor utility. As a result, there is a loss of information in this translation since multiple integers on the scale \mbox{[}0,150\mbox{]} map to the scale \mbox{[}0,58\mbox{]}. \hypertarget{wireless-upload}{}\doxysection{Wireless Upload and Hot/\+Cold Linking}\label{wireless-upload}
\begin{DoxyNote}{Note}
Wireless Upload requires at least C\+LI 3.\+1.\+4, Kernel 3.\+1.\+6, V\+E\+Xos 1.\+0.\+5, and Okapi\+Lib 3.\+3.\+12 (if used).
\end{DoxyNote}
P\+R\+OS supports wireless upload to the V5 Brain via a V5 Controller. Although there are no special requirements to enable P\+R\+OS to do this, file transfer speeds are typically unacceptably slow. To make them more reasonable, P\+R\+OS has a different method of compiling your project so that the P\+R\+OS kernel and other infrequently modified code are uploaded once and only the code you regularly modify (e.\+g. opcontrol.\+cpp, autonomous.\+cpp, and initialize.\+cpp) gets transferred to the V5 wirelessly. We call the code you upload once and never change the \char`\"{}cold
image\char`\"{} and the code that changes frequently and gets uploaded every time the \char`\"{}hot image.\char`\"{}

To enable this compilation mode, you should open your project\textquotesingle{}s Makefile and edit the line\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\# Set to 1 to enable hot/cold linking}
\DoxyCodeLine{USE\_PACKAGE:=0}
\end{DoxyCode}


so that {\ttfamily U\+S\+E\+\_\+\+P\+A\+C\+K\+A\+GE\+:=1}. Re-\/build and upload your project and P\+R\+OS will automatically use the new files. P\+R\+OS will automatically detect when you\textquotesingle{}re using the same combination of libraries and decide not to re-\/upload the \char`\"{}cold\char`\"{} code. Verification that the library is present is done with filename and checksum of the file. As a result, if you use the same combination of libraries (cold image), only one copy of the cold image is uploaded to the V5.\hypertarget{wireless-upload_autotoc_md64}{}\doxysubsubsection{Large Projects}\label{wireless-upload_autotoc_md64}
Projects with large codebases may still take some time to upload even with hot/cold linking. You may be able to reduce the size of your hot image by making part of your project a library so that some code is included in the cold image. To do so, edit the following lines of your project\textquotesingle{}s Makefile\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\# Set this to 1 to add additional rules to compile your project as a PROS library template}
\DoxyCodeLine{IS\_LIBRARY:=0}
\DoxyCodeLine{\# TODO: CHANGE THIS!}
\DoxyCodeLine{LIBNAME:=libbest}
\DoxyCodeLine{VERSION:=1.0.0}
\DoxyCodeLine{\# EXCLUDE\_SRC\_FROM\_LIB= \$(SRCDIR)/unpublishedfile.c}
\end{DoxyCode}


Change {\ttfamily I\+S\+\_\+\+L\+I\+B\+R\+A\+RY} to {\ttfamily 1} and rename the library to something of your choosing. We recommend {\ttfamily lib$<$robot name$>$} or {\ttfamily lib$<$team number$>$} (e.\+g. {\ttfamily lib7701}) to be unique enough to avoid cause naming conflicts with other cold images. When compiling, P\+R\+OS will include this library as part of the cold image. Your library should only contain files you infrequently change so that you do not have to frequently upload the cold image. By default, the Makefile is set up to exclude your project\textquotesingle{}s opcontrol.\+cpp, autonomous.\+cpp, and initialize.\+cpp files. If you change other files frequently, you can add lines like {\ttfamily E\+X\+C\+L\+U\+D\+E\+\_\+\+S\+R\+C\+\_\+\+F\+R\+O\+M\+\_\+\+L\+I\+B+=/myfile.c} as needed.

{\bfseries{An important caveat}} is that code that goes into the cold image is {\bfseries{not}} able to link against anything (call functions or use variables) in the hot image. Doing so will result in a linker error -\/ you will be told what\textquotesingle{}s trying to refer to what in the hot image\+: \begin{DoxyVerb}bin/libtheseus.a(lcdselector.cpp.o):(.data.inits+0x0): undefined reference to `auton::allianceInit(auton::color)'
\end{DoxyVerb}


You should refactor your code so that only \char`\"{}hot\char`\"{} code calls \char`\"{}cold\char`\"{} code or include the culprit file in the hot image.

An example of a modified Makefile\textquotesingle{}s relevant lines is shown below\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\# Set to 1 to enable hot/cold linking}
\DoxyCodeLine{USE\_PACKAGE=1}
\DoxyCodeLine{}
\DoxyCodeLine{\# Set this to 1 to add additional rules to compile your project as a PROS library template}
\DoxyCodeLine{IS\_LIBRARY:=1}
\DoxyCodeLine{LIBNAME:=libtheseus}
\DoxyCodeLine{VERSION:=1.0.0}
\DoxyCodeLine{\# this line excludes opcontrol.c and similar files}
\DoxyCodeLine{EXCLUDE\_SRC\_FROM\_LIB+=\$(foreach file, \$(SRCDIR)/opcontrol \$(SRCDIR)/initialize \$(SRCDIR)/autonomous,\$(foreach cext,\$(CEXTS),\$(file).\$(cext)) \$(foreach cxxext,\$(CXXEXTS),\$(file).\$(cxxext)))}
\DoxyCodeLine{EXCLUDE\_SRC\_FROM\_LIB+=\$(SRCDIR)/scripts             \# exclude any files in the src/scripts directory}
\DoxyCodeLine{EXCLUDE\_SRC\_FROM\_LIB+=\$(SRCDIR)/lcdselector.cpp     \# exclude src/lcdselector.cpp}
\end{DoxyCode}
\hypertarget{wireless-upload_autotoc_md65}{}\doxysubsubsection{Hot/\+Cold Linking Troubleshooting}\label{wireless-upload_autotoc_md65}
Since hot/cold linking involves ensuring two compiled programs interact consistently, there may be additional runtime issues running in this mode. This section serves as a guide for debugging these sorts of issues.

Generally, if the program appears to be running correctly (i.\+e. the screen shows), then the compilation mode worked correctly and the error you\textquotesingle{}re experiencing is likely related to your code\textquotesingle{}s logic. If your code\textquotesingle{}s logic runs correctly when not using hot/cold linking, contact us so we may assist in troubleshooting.

If you see a black scren, then P\+R\+OS did not boot correctly.


\begin{DoxyItemize}
\item A global constructor is in an infinite loop or raised an exception.
\item See also troubleshooting steps below
\end{DoxyItemize}

If you see a grey screen, then P\+R\+OS booted correctly, but is not running your hot image.


\begin{DoxyItemize}
\item Delete all user programs, perform a clean build, and upload
\end{DoxyItemize}

If you\textquotesingle{}re having issues, contact us so we may assist in troubleshooting. 